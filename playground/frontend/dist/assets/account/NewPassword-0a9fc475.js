import{d as e,c as s,b as r,e as a,f as l,n as t,g as o,t as n,r as i,a as d,u,h as c,i as p,w as m,F as v,j as w,T as g,l as h,U as f,m as x,p as _}from"./index-f92b2378.js";import{c as y,u as b,r as k,a as $,b as V}from"./validators-e255ce09.js";const z={class:"grid w-full h-1 grid-cols-4 gap-4 mt-3"},A=e({__name:"PasswordStrengthIndicator",props:{value:{type:String,default:""}},setup(e){const i=e;var d=new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.{12,})"),u=new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.{8,})"),c=new RegExp("^(((?=.*[a-z])(?=.*[A-Z]))|((?=.*[a-z])(?=.*[0-9]))|((?=.*[A-Z])(?=.*[0-9])))(?=.{6,})"),p=new RegExp("^(?=.*[a-z])|(?=.*[A-Z])|(?=.*[0-9])");const m=s((()=>w.value>=3?"bg-green-500":"bg-red-500")),v=s((()=>w.value>=3?"text-green-500":"text-red-500")),w=s((()=>i.value&&0!==i.value.length?d.test(i.value)?4:u.test(i.value)?3:c.test(i.value)?2:p.test(i.value)?1:0:0)),g=s((()=>"password.strength."+(w.value<=2?"weak":w.value>3?"strong":"good")));return(e,s)=>(r(),a("div",null,[l("div",z,[l("div",{class:t(["h-full rounded",[o(w)<1?"bg-gray-200":o(m)]])},null,2),l("div",{class:t(["h-full rounded",[o(w)<2?"bg-gray-200":o(m)]])},null,2),l("div",{class:t(["h-full rounded",[o(w)<3?"bg-gray-200":o(m)]])},null,2),l("div",{class:t(["h-full rounded dark:bg-dark-1",[o(w)<4?"bg-gray-200":o(m)]])},null,2)]),l("div",{class:t(["text-sm mt-2",o(v)])},n(e.$t(o(g))),3)]))}}),R={class:"grow min-h-full py-4 sm:py-12 sm:px-6 lg:px-8 grid content-center"},j={class:"mb-16 md:mb-24"},Z={class:"sm:mx-auto sm:w-full sm:max-w-2xl text-center space-x-2 mb-4"},q=["src"],C={class:"mt-4 sm:mx-auto sm:w-full sm:max-w-lg drop-shadow-2xl"},U={class:"bg-white py-6 px-4 shadow sm:rounded-lg sm:px-10"},E={class:"text-center text-2xl font-bold mb-5"},S={class:"space-y-5",action:"",method:"POST"},L={key:0,class:"rounded-md bg-red-50 p-4 -mx-2"},M={class:"flex"},P={class:"flex-shrink-0"},H={key:0,class:"ml-3 text-sm font-medium text-red-800"},T={class:"flex items-center justify-between"},X={class:"text-sm"},B={class:"list-disc list-inside ml-2 mt-1"},F={class:"pt-4"},I=["onClick"],N={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},O=[l("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),l("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)],W={__name:"NewPassword",setup(e){const z=i({password:"",password_verify:""}),W=d(!1),D=d(!1),G=_("whitelabel"),J={color:G.logo_text},K=new RegExp("^(?=.*[A-Z])(?=.*[0-9])(?=.{8,})"),Q=y.withMessage("validations.password_too_simple",(e=>K.test(e))),Y=y.withMessage("validations.password_verify_mismatch",(e=>e===z.password)),ee=s((()=>({password:{required:$,passwordComplexityValidator:Q},password_verify:{required:$,passwordVerifyValidator:Y}}))),se=b(ee,z),re={excessive_login_attempts:{title:"errors.excessive_login_attempts.title",description:"errors.excessive_login_attempts.description"},bad_credentials:{description:"errors.bad_credentials"},inactive_account:{title:"errors.inactive_account"},internal_server_error:{title:"errors.internal_server_error",description:"errors.description"}},ae=d(null),le=s((()=>({general:oe(ae.value)}))),te=u();function oe(e){if(!e)return null;if(re[e])return re[e];let s=te.te("errors."+e+".title"),r=te.te("errors."+e+".description");return s||r?{title:s?"errors."+e+".title":null,description:r?"errors."+e+".description":null}:{title:"errors.unknown_error",description:e}}function ne(e){!0!==D.value&&(se.value.$validate(),se.value.$errors.length||(D.value=!0,function(){const e={token:"",password:z.password};let s=new URL("http://localhost:8082/reset_password");V.post(s.href,e,{headers:{"X-Requested-With":"XMLHttpRequest"}}).then((e=>{e.data.redirect?document.location.href=e.data.redirect:document.location.href="",D.value=!1})).catch((e=>{if(D.value=!1,e.response&&e.response.data.error)return e.response.data.error,void(ae.value=e.response.data.error);if(e.response)switch(e.response.status){case 500:ae.value="errors.internal_server_error";break;case 404:case 502:case 503:case 504:ae.value="errors.temporary_unavailable";break;case 400:ae.value="errors.validation";break;default:ae.value=e.toLocaleString()}else ae.value=e.toLocaleString()}))}()))}return(e,s)=>{var i,d;return r(),a("div",R,[l("div",j,[l("div",Z,[o(G).logo?(r(),a("img",{key:0,class:t(["w-auto inline drop-shadow",{"h-20":o(G).only_logo,"h-16":!o(G).only_logo}]),src:o(G).logo},null,10,q)):c("",!0),o(G).only_logo?c("",!0):(r(),a("span",{key:1,class:"text-4xl font-bold text-gray-800 drop-shadow align-middle stroke-1 stroke-black",style:J},n(o(G).title),1))]),l("div",C,[l("div",U,[l("h2",E,n(e.$t("page.password.title:new_password")),1),l("form",S,[p(g,{name:"fade"},{default:m((()=>[o(le).general?(r(),a("div",L,[l("div",M,[l("div",P,[p(o(k),{class:"h-5 w-5 text-red-400","aria-hidden":"true"})]),l("div",null,[o(le).general.title?(r(),a("h3",H,n(e.$t(o(le).general.title)),1)):c("",!0),o(le).general.description?(r(),a("div",{key:1,class:t(["ml-3 text-sm text-red-700",{"mt-2":o(le).general.title}])},[(r(!0),a(v,null,w(e.$t(o(le).general.description).split(/\n/g),(e=>(r(),a("p",null,n(e)+"Â ",1)))),256))],2)):c("",!0)])])])):c("",!0)])),_:1}),l("div",T,[l("div",X,[h(" U kunt uw nieuwe wachtwoord instellen, uw wachtwoord moet minmaal aan de volgende eisen voldoen: "),l("ul",B,[l("li",{class:t([W.value?z.password.length>=8?"text-green-500":"text-red-500":""])},"minimaal 8 karakters lang zijn ",2),l("li",{class:t([W.value?z.password.match(/[A-Z]/)?"text-green-500":"text-red-500":""])},"minimaal 1 hoofdletter ",2),l("li",{class:t([W.value?z.password.match(/[0-9]/)?"text-green-500":"text-red-500":""])},"minimaal 1 cijfer ",2)])])]),l("div",null,[p(o(f),{label:"form.new_password",name:"password",type:"password",required:!0,modelValue:z.password,"onUpdate:modelValue":[s[0]||(s[0]=e=>z.password=e),s[1]||(s[1]=e=>W.value=!0)],error:null==(i=o(se).password.$errors[0])?void 0:i.$message,placeholder:e.$t("form.new_password:placeholder")},null,8,["modelValue","error","placeholder"])]),p(A,{value:z.password,"onUpdate:value":s[2]||(s[2]=e=>z.password=e)},null,8,["value"]),l("div",null,[p(o(f),{label:"form.password_verify",name:"password_verify",type:"password",required:!0,modelValue:z.password_verify,"onUpdate:modelValue":s[3]||(s[3]=e=>z.password_verify=e),error:null==(d=o(se).password_verify.$errors[0])?void 0:d.$message,placeholder:e.$t("form.password_verify:placeholder")},null,8,["modelValue","error","placeholder"])]),l("div",F,[l("button",{type:"submit",class:"w-full primary inline-flex justify-center",onClick:x(ne,["prevent"])},[D.value?(r(),a("svg",N,O)):c("",!0),h(" "+n(e.$t("page.password.button:reset")),1)],8,I)])])])])])])}}};export{W as default};
